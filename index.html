<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invoice Management System</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #4285F4;
      --success: #34A853;
      --warning: #FBBC04;
      --danger: #EA4335;
      --text: #202124;
      --text-secondary: #5F6368;
      --border: #DADCE0;
      --bg: #FFFFFF;
      --bg-secondary: #F8F9FA;
    }

    [data-theme="dark"] {
      --text: #D4D4D4;
      --text-secondary: #8f8e8e;
      --border: #454545;
      --bg: #1a1e3d;
      --bg-secondary: #2b3157;
    }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', sans-serif;
      background: var(--bg-secondary);
      color: var(--text);
      line-height: 1.4;
      transition: background-color 0.3s, color 0.3s;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
      padding: 16px;
    }

    @media (max-width: 1024px) {
      .container {
        padding: 12px;
      }

      .main-content {
        grid-template-columns: 1fr;
      }

      .metrics-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }

      .metric-card {
        padding: 16px;
      }

      .metric-value {
        font-size: 24px;
      }

      .header {
        padding: 16px 20px;
      }

      .upload-section,
      .invoices-section {
        padding: 20px;
      }

      .setup-header {
        padding: 32px 24px;
      }

      .setup-body {
        padding: 24px;
      }
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
      }

      .metrics-grid {
        grid-template-columns: 1fr;
      }

      .header {
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
      }

      .setup-content {
        width: 95%;
        max-height: 85vh;
      }

      .setup-header h1 {
        font-size: 22px;
      }

      .upload-buttons {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }

    .setup-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }

    .setup-modal.active {
      display: flex;
    }

    .setup-content {
      background: white;
      border-radius: 16px;
      padding: 0;
      max-width: 580px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    [data-theme="dark"] .setup-content {
      background: #323232;
    }

    .modal-close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.15);
      border: none;
      border-radius: 8px;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      z-index: 10;
      backdrop-filter: blur(10px);
    }

    .modal-close-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }

    .modal-close-btn svg {
      width: 20px;
      height: 20px;
      color: white;
    }

    .setup-header {
      background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
      padding: 48px 40px;
      text-align: center;
      color: white;
    }

    .setup-header-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 24px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
    }

    .setup-header-icon svg {
      width: 32px;
      height: 32px;
    }

    .setup-header h1 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 12px;
      letter-spacing: -0.5px;
    }

    .setup-header p {
      font-size: 15px;
      opacity: 0.9;
      font-weight: 400;
    }

    .setup-body {
      padding: 40px;
    }

    .setup-step {
      margin-bottom: 28px;
    }

    .setup-step:last-of-type {
      margin-bottom: 0;
    }

    .setup-step label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--text);
      font-size: 14px;
    }

    .setup-step label svg {
      width: 18px;
      height: 18px;
      color: #1a73e8;
    }

    .setup-step input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 14px;
      font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
      transition: all 0.3s;
      background: var(--bg-secondary);
      color: var(--text);
    }

    .setup-step input:focus {
      outline: none;
      border-color: #1a73e8;
      background: var(--bg);
      box-shadow: 0 0 0 4px rgba(26, 115, 232, 0.1);
    }

    .setup-step .help-text {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 8px;
      line-height: 1.5;
    }

    .setup-step .help-text a {
      color: #1a73e8;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }

    .setup-step .help-text a:hover {
      color: #1557b0;
    }

    .info-banner {
      background: #e8f0fe;
      border: 1px solid #d2e3fc;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 28px;
      display: flex;
      gap: 12px;
      align-items: start;
    }

    [data-theme="dark"] .info-banner {
      background: rgba(26, 115, 232, 0.1);
      border-color: rgba(26, 115, 232, 0.3);
    }

    .info-banner svg {
      width: 20px;
      height: 20px;
      color: #1a73e8;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .info-banner-content {
      flex: 1;
    }

    .info-banner-title {
      font-weight: 600;
      font-size: 14px;
      color: #1a73e8;
      margin-bottom: 4px;
    }

    .info-banner-text {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .setup-actions {
      display: flex;
      gap: 12px;
      margin-top: 36px;
      padding-top: 32px;
      border-top: 1px solid var(--border);
    }

    .btn-setup {
      flex: 1;
      padding: 16px 24px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-setup svg {
      width: 18px;
      height: 18px;
    }

    .btn-setup.primary {
      background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.4);
    }

    .btn-setup.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(26, 115, 232, 0.5);
    }

    .btn-setup.secondary {
      background: var(--bg-secondary);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-setup.secondary:hover {
      background: var(--border);
    }

    .header {
      background: var(--bg);
      border-radius: 12px;
      padding: 10px 20px;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo img {
      height: 100%;
      width: auto;
      object-fit: contain;
    }





    .header-title {
      display: flex;
      align-items: center;
    }

    .header-title p {
      font-size: 16px;
      color: var(--text);
      font-weight: 600;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .theme-toggle {
      width: 42px;
      height: 42px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      color: var(--text);
    }

    .theme-toggle:hover {
      background: var(--border);
      transform: translateY(-2px);
    }

    .connect-btn {
      padding: 8px 20px;
      background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
      border: none;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
      color: white;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3);
    }

    .connect-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.4);
    }

    .connect-btn svg {
      width: 16px;
      height: 16px;
    }

    .connect-btn.connected {
      background: linear-gradient(135deg, #34A853 0%, #5FBD73 100%);
      box-shadow: 0 2px 8px rgba(52, 168, 83, 0.3);
    }

    .connect-btn.connected:hover {
      box-shadow: 0 4px 12px rgba(52, 168, 83, 0.4);
    }

    .quick-actions-wrapper {
      position: relative;
    }

    .quick-actions-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .quick-actions-btn:hover {
      background: var(--border);
      transform: translateY(-2px);
    }

    .quick-actions-btn svg {
      width: 16px;
      height: 16px;
    }

    .quick-actions-menu {
      display: none;
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      min-width: 200px;
      z-index: 1000;
      overflow: hidden;
    }

    .quick-actions-menu.active {
      display: block;
      animation: dropdownFade 0.2s ease-out;
    }

    @keyframes dropdownFade {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .quick-actions-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      cursor: pointer;
      transition: background 0.2s;
      color: var(--text);
      text-decoration: none;
      font-size: 14px;
    }

    .quick-actions-item:hover {
      background: var(--bg-secondary);
    }

    .quick-actions-item svg {
      width: 18px;
      height: 18px;
      color: var(--primary);
    }

    .quick-actions-divider {
      height: 1px;
      background: var(--border);
      margin: 4px 0;
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: 200px 200px 1fr;
      /* narrowed columns */
      gap: 12px;
      margin-bottom: 12px;
      /* Reduced margin */
    }

    .metric-card {
      background: var(--bg);
      border-radius: 12px;
      padding: 12px;
      /* Reduced padding */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .metric-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }

    .metric-icon {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
    }

    .metric-icon svg {
      width: 24px;
      height: 24px;
    }

    .metric-icon.blue {
      background: #E8F0FE;
      color: var(--primary);
    }

    .metric-icon.green {
      background: #E8F5E9;
      color: var(--success);
    }

    .metric-icon.red {
      background: #FCE8E6;
      color: var(--danger);
    }

    .metric-icon.yellow {
      background: #FEF7E0;
      color: var(--warning);
    }

    .metric-value {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .metric-label {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }

    .metric-change {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      background: #E8F5E9;
      color: #34A853;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }

    [data-theme="dark"] .metric-change {
      background: #1E3A2E;
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      /* Equal width to make invoices narrower */
      gap: 16px;
      margin-bottom: 12px;
    }

    .card {
      background: var(--bg);
      border-radius: 12px;
      padding: 16px;
      /* Reduced padding */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
    }

    .card-subtitle {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .upload-area {
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 48px 24px;
      text-align: center;
      transition: all 0.3s;
      background: var(--bg-secondary);
      cursor: pointer;
    }

    .upload-area:hover {
      border-color: var(--primary);
      background: var(--bg);
    }

    .upload-area.drag-over {
      border-color: var(--primary);
      background: #E8F0FE;
    }

    [data-theme="dark"] .upload-area.drag-over {
      background: rgba(66, 133, 244, 0.1);
    }

    .upload-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: #E8F0FE;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
    }

    .upload-icon svg {
      width: 32px;
      height: 32px;
    }

    .upload-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .upload-subtitle {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .upload-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: none;
    }

    .btn svg {
      width: 18px;
      height: 18px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.4);
    }

    .btn-secondary {
      background: var(--bg-secondary);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--border);
    }

    .progress-container {
      display: none;
      margin-top: 24px;
    }

    .progress-container.active {
      display: block;
    }

    .progress-bar {
      height: 8px;
      background: var(--bg-secondary);
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #1a73e8, #4285f4);
      border-radius: 8px;
      transition: width 0.3s ease;
    }

    .progress-text {
      font-size: 14px;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 20px;
    }

    .progress-steps {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .progress-step {
      text-align: center;
    }

    .progress-step-icon {
      width: 40px;
      height: 40px;
      margin: 0 auto 8px;
      background: var(--bg-secondary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      transition: all 0.3s;
    }

    .progress-step.active .progress-step-icon {
      background: #E8F0FE;
      color: var(--primary);
    }

    .progress-step.complete .progress-step-icon {
      background: #E8F5E9;
      color: var(--success);
    }

    .progress-step-label {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .invoices-table-wrapper {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      min-height: 0;
      max-height: 35vh;
      /* Reduced height to fit screen */
    }

    .invoices-table {
      width: 100%;
      border-collapse: collapse;
    }

    .invoices-table thead {
      background: var(--bg-secondary);
    }

    .invoices-table th {
      text-align: left;
      padding: 12px 16px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 2px solid var(--border);
    }

    .invoices-table td {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .invoices-table tbody tr {
      transition: background 0.2s;
    }

    .invoices-table tbody tr:hover {
      background: var(--bg-secondary);
    }

    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .status-processed {
      background: #E8F5E9;
      color: #34A853;
    }

    [data-theme="dark"] .status-processed {
      background: #1E3A2E;
    }

    .view-all-link {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: var(--primary);
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
      transition: gap 0.2s;
    }

    .view-all-link:hover {
      gap: 8px;
    }

    .toast-container {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .toast {
      background: white;
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 320px;
      animation: slideIn 0.3s ease-out;
    }

    [data-theme="dark"] .toast {
      background: #3C3C3C;
      border: 1px solid #454545;
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .toast-icon {
      flex-shrink: 0;
    }

    .toast-content {
      flex: 1;
    }

    .toast-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .toast-message {
      font-size: 13px;
      color: var(--text-secondary);
    }

    #fileInput {
      display: none;
    }

    /* Chart Card Styles */
    .chart-card {
      background: var(--bg);
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      padding: 24px;
      /* grid-column: span 2; Removed for adaptive grid */
      transition: all 0.3s;
    }

    [data-theme="dark"] .chart-card {
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .chart-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .chart-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }

    .chart-controls {
      display: flex;
      gap: 8px;
    }

    .chart-btn {
      padding: 6px 16px;
      border: 2px solid var(--border);
      background: var(--bg);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .chart-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .chart-btn.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    .chart-container {
      position: relative;
      height: 200px;
      /* Reduced height */
      width: 100%;
    }

    @media (max-width: 1024px) {
      .chart-card {
        grid-column: span 1;
      }

      .chart-container {
        height: 240px;
      }
    }

    @media (max-width: 768px) {
      .chart-header {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }

      .chart-controls {
        width: 100%;
      }

      .chart-btn {
        flex: 1;
      }
    }

    @media (max-width: 1024px) {
      .metrics-grid {
        grid-template-columns: repeat(2, 1fr) !important;
      }

      .chart-card {
        grid-column: span 2 !important;
      }
    }

    @media (max-width: 768px) {
      .metrics-grid {
        grid-template-columns: 1fr !important;
      }

      .chart-card {
        grid-column: span 1 !important;
      }

      .main-content {
        grid-template-columns: 1fr !important;
      }

      .header {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr !important;
      }

      .header {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <div id="setupModal" class="setup-modal">
    <div class="setup-content">
      <button class="modal-close-btn" onclick="closeSetupModal()" title="Close">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <div class="setup-header">
        <div class="setup-header-icon">
          <img src="data:image/png;base64,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" style="width: 80%; height: 80%; object-fit: contain;" alt="Invoice AI">
        </div>
        <h1>Welcome to Invoice System</h1>
        <p>Connect your Google Sheet to get started</p>
      </div>

      <div class="setup-body">
        <div class="info-banner">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          <div class="info-banner-content">
            <div class="info-banner-title">First Time Setup - 2 Simple Steps</div>
            <div class="info-banner-text">
              1. Copy the template and run "Initial Setup"<br>
              2. Paste your Sheet ID and Folder ID below
            </div>
          </div>
        </div>

        <div class="setup-step">
          <label>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="9" y1="9" x2="15" y2="9"></line>
              <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
            Sheet ID
          </label>
          <input type="text" id="sheetIdInput" placeholder="Paste Sheet ID or URL here">
          <div class="help-text">
            Find this in your Sheet's INSTRUCTIONS tab after running setup
          </div>
        </div>

        <div class="setup-step">
          <label>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            Drive Folder ID
          </label>
          <input type="text" id="folderIdInput" placeholder="Paste Folder ID or URL here">
          <div class="help-text">
            Also found in the INSTRUCTIONS tab of your copied Sheet
          </div>
        </div>

        <div class="setup-actions">
          <button class="btn-setup secondary" onclick="openTemplateLink()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy Template
          </button>
          <button class="btn-setup primary" onclick="saveConfiguration()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            Save & Continue
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <img
            src="data:image/webp;base64,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"
            alt="Invoice AI">
        </div>
        <div class="header-title">
          <p>AI-Powered Invoice Processing</p>
        </div>
      </div>
      <div class="header-right">
        <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
          <svg id="themeIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>

        <div class="quick-actions-wrapper">
          <button class="quick-actions-btn" onclick="toggleQuickActions()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="1"></circle>
              <circle cx="19" cy="12" r="1"></circle>
              <circle cx="5" cy="12" r="1"></circle>
            </svg>
            Quick Actions
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>

          <div id="quickActionsMenu" class="quick-actions-menu">
            <div class="quick-actions-item" onclick="openUserSheet()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              Open Sheet
            </div>

            <div class="quick-actions-item" onclick="openUserDrive()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
              </svg>
              Open Drive
            </div>

            <div class="quick-actions-divider"></div>

            <div class="quick-actions-item" onclick="refreshDashboard()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
              Refresh Data
            </div>

            <div class="quick-actions-divider"></div>

            <div class="quick-actions-item" onclick="showSetupModal(); toggleQuickActions();">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v2m0 18v2m9-11h-2M5 12H3m15.364-6.364l-1.414 1.414M6.05 17.95l-1.414 1.414m12.728 0l-1.414-1.414M6.05 6.05L4.636 4.636"></path>
              </svg>
              Settings
            </div>
          </div>
        </div>

        <button class="connect-btn" id="connectBtn" onclick="showSetupModal()" title="Connect your system">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
          </svg>
          Connect
        </button>
      </div>
    </header>

    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-icon blue">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
          </svg>
        </div>
        <div class="metric-value" id="totalInvoices">0</div>
        <div class="metric-label">Total Invoices</div>
        <span class="metric-change"> This month</span>
      </div>

      <div class="metric-card">
        <div class="metric-icon green">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"></line>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>
        </div>
        <div class="metric-value" id="totalAmount">0</div>
        <div class="metric-label">Total Amount</div>
        <span class="metric-change">All invoices</span>
      </div>

      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title">Invoice Activity</div>
          <div class="chart-controls">
            <button class="chart-btn active" onclick="loadChartData('week')">Week</button>
            <button class="chart-btn" onclick="loadChartData('month')">Month</button>
            <button class="chart-btn" onclick="loadChartData('year')">Year</button>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="invoiceChart"></canvas>
        </div>
      </div>
    </div>

    <div class="main-content">
      <div class="card upload-section">
        <div class="card-header">
          <div>
            <div class="card-title">Upload Invoice</div>
            <div class="card-subtitle">Drag and drop or choose a file to process</div>
          </div>
        </div>

        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
          </div>
          <div class="upload-title">Upload Invoice Document</div>
          <div class="upload-subtitle">Supported formats: PDF, JPG, PNG (Max 10MB)</div>
          <div class="upload-buttons">
            <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
              </svg>
              Choose File
            </button>
            <button class="btn btn-secondary" onclick="takePhoto()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                <circle cx="12" cy="13" r="4"></circle>
              </svg>
              Take Photo
            </button>
          </div>
          <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(event)">
        </div>

        <div id="progressContainer" class="progress-container">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
          </div>
          <div id="progressText" class="progress-text">Processing...</div>
          <div class="progress-steps">
            <div class="progress-step" data-step="1">
              <div class="progress-step-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="17 8 12 3 7 8"></polyline>
                  <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
              </div>
              <div class="progress-step-label">Upload</div>
            </div>
            <div class="progress-step" data-step="2">
              <div class="progress-step-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                  <circle cx="12" cy="12" r="3"></circle>
                </svg>
              </div>
              <div class="progress-step-label">Extract</div>
            </div>
            <div class="progress-step" data-step="3">
              <div class="progress-step-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
              <div class="progress-step-label">Validate</div>
            </div>
            <div class="progress-step" data-step="4">
              <div class="progress-step-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                  <polyline points="17 21 17 13 7 13 7 21"></polyline>
                  <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
              </div>
              <div class="progress-step-label">Save</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card invoices-section">
        <div class="card-header">
          <div>
            <div class="card-title">Recent Invoices</div>
            <div class="card-subtitle">Last 10 processed invoices</div>
          </div>
          <a href="#" class="view-all-link" onclick="viewAllInvoices(); return false;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            View All
          </a>
        </div>

        <div class="invoices-table-wrapper">
          <table class="invoices-table">
            <thead>
              <tr>
                <th>Vendor</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="invoicesTableBody">
              <tr>
                <td colspan="4" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                  No invoices yet. Upload your first invoice to get started!
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div id="toastContainer" class="toast-container"></div>

  <script>
    const CONFIG = {
      N8N_WEBHOOK_URL: 'https://yehuda-levi-n8n.nr6aco.easypanel.host/webhook-test/PJ30-yehuda',
      CENTRAL_APPS_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbxNLnadD8rdu5gCTOpIJhJ88XV1Ms8702XD6kJrq9_OG5aJ1JW29pCzckG43JUuO3M6kg/exec',
      TEMPLATE_URL: 'https://docs.google.com/spreadsheets/d/1x3XTMFMEl5K_UIY0KdBtkCdpbleHUWArPXXz5s5yqjk/copy'
    };

    let currentInvoiceId = null;

    function initTheme() {
      const theme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', theme);
      updateThemeIcon(theme);
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeIcon(newTheme);
    }

    function updateThemeIcon(theme) {
      const icon = document.getElementById('themeIcon');
      if (theme === 'dark') {
        icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
      } else {
        icon.innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
      }
    }

    function showSetupModal() {
      const modal = document.getElementById('setupModal');
      modal.classList.add('active');

      const sheetId = localStorage.getItem('userSheetId') || '';
      const folderId = localStorage.getItem('userFolderId') || '';
      document.getElementById('sheetIdInput').value = sheetId;
      document.getElementById('folderIdInput').value = folderId;
    }

    function closeSetupModal() {
      document.getElementById('setupModal').classList.remove('active');
    }

    function openTemplateLink() {
      window.open(CONFIG.TEMPLATE_URL, '_blank');
    }

    function saveConfiguration() {
      const sheetInput = document.getElementById('sheetIdInput').value.trim();
      const folderInput = document.getElementById('folderIdInput').value.trim();

      if (!sheetInput || !folderInput) {
        showToast('Missing Information', 'Please enter both Sheet ID and Folder ID', 'error');
        return;
      }

      const sheetId = extractGoogleId(sheetInput);
      const folderId = extractGoogleId(folderInput);

      localStorage.setItem('userSheetId', sheetId);
      localStorage.setItem('userFolderId', folderId);

      closeSetupModal();
      updateConnectButton();
      showToast('Configuration Saved', 'Your system is now ready to process invoices', 'success');
      loadDashboard();
    }

    function checkConfiguration() {
      const sheetId = localStorage.getItem('userSheetId');
      const folderId = localStorage.getItem('userFolderId');

      updateConnectButton();

      if (!sheetId || !folderId) {
        showSetupModal();
      } else {
        loadDashboard();
      }
    }

    async function loadDashboard() {
      await loadMetrics();
      await loadRecentInvoices();
      await loadInitialChart();
    }

    async function loadMetrics() {
      const sheetId = localStorage.getItem('userSheetId');

      if (!sheetId) return;

      try {
        const response = await fetch(`${CONFIG.CENTRAL_APPS_SCRIPT_URL}?action=metrics&sheetId=${sheetId}`);
        const data = await response.json();

        console.log('Metrics response:', data);

        if (data.error) {
          console.warn('Metrics error:', data.error);
          return;
        }

        document.getElementById('totalInvoices').textContent = data.totalInvoices || 0;
        document.getElementById('totalAmount').textContent = data.totalAmount || '0';
      } catch (error) {
        console.error('Error loading metrics:', error);
      }
    }

    async function loadRecentInvoices() {
      const sheetId = localStorage.getItem('userSheetId');

      if (!sheetId) return;

      try {
        const response = await fetch(`${CONFIG.CENTRAL_APPS_SCRIPT_URL}?action=recentInvoices&sheetId=${sheetId}`);
        const data = await response.json();

        console.log('Recent invoices response:', data);

        if (data.error || !Array.isArray(data) || data.length === 0) {
          return;
        }

        const tbody = document.getElementById('invoicesTableBody');
        tbody.innerHTML = data.map(invoice => `
          <tr>
            <td>${invoice.VENDOR_NAME || 'N/A'}</td>
            <td>${invoice.TOTAL_AMOUNT || 0}</td>
            <td>${invoice.INVOICE_DATE || 'N/A'}</td>
            <td><span class="status-badge status-processed">Processed</span></td>
          </tr>
        `).join('');
      } catch (error) {
        console.error('Error loading invoices:', error);
      }
    }

    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        uploadInvoice(file);
      }
    }

    async function uploadInvoice(file) {
      const sheetId = localStorage.getItem('userSheetId');
      const folderId = localStorage.getItem('userFolderId');

      if (!sheetId || !folderId) {
        showToast('Configuration Required', 'Please configure your system first', 'error');
        showSetupModal();
        return;
      }

      let initialCount = 0;
      try {
        console.log('Getting initial invoice count...');
        const metricsResponse = await fetch(`${CONFIG.CENTRAL_APPS_SCRIPT_URL}?action=metrics&sheetId=${sheetId}`);
        const metricsData = await metricsResponse.json();
        initialCount = metricsData.totalInvoices || 0;
        console.log('Initial invoice count:', initialCount);
      } catch (error) {
        console.warn('Could not get initial invoice count:', error);
      }

      const progressContainer = document.getElementById('progressContainer');
      const progressFill = document.getElementById('progressFill');
      const progressText = document.getElementById('progressText');

      progressContainer.classList.add('active');
      progressFill.style.width = '0%';
      progressText.textContent = 'Preparing upload...';
      updateProgressStep(1, 'active');

      currentInvoiceId = generateUUID();
      const formData = new FormData();
      formData.append('file', file);
      formData.append('invoiceId', currentInvoiceId);
      formData.append('source', 'file');
      formData.append('userId', 'user');
      formData.append('sheetId', sheetId);
      formData.append('folderId', folderId);

      try {
        progressFill.style.width = '25%';
        progressText.textContent = 'Uploading to secure storage...';

        const response = await fetch(CONFIG.N8N_WEBHOOK_URL, {
          method: 'POST',
          body: formData
        });

        if (!response.ok) {
          throw new Error('Upload failed');
        }

        updateProgressStep(1, 'complete');
        updateProgressStep(2, 'active');
        progressFill.style.width = '50%';
        progressText.textContent = 'Extracting invoice data...';

        setTimeout(() => {
          updateProgressStep(2, 'complete');
          updateProgressStep(3, 'active');
          progressFill.style.width = '75%';
          progressText.textContent = 'Validating information...';
        }, 1500);

        setTimeout(async () => {
          updateProgressStep(3, 'complete');
          updateProgressStep(4, 'active');
          progressFill.style.width = '90%';
          progressText.textContent = 'Saving to database...';

          const processed = await waitForProcessing(initialCount);

          if (processed) {
            updateProgressStep(4, 'complete');
            progressFill.style.width = '100%';
            progressText.textContent = 'Invoice processed successfully!';
            showToast('Success', 'Invoice processed and saved successfully', 'success');
          } else {
            updateProgressStep(4, 'complete');
            progressFill.style.width = '100%';
            progressText.textContent = 'Processing may take longer...';
            showToast('Processing', 'Invoice uploaded. Refresh the page to see updated data.', 'success');
          }

          setTimeout(() => {
            progressContainer.classList.remove('active');
            resetProgressSteps();
            loadDashboard();
          }, 2000);
        }, 3000);

      } catch (error) {
        console.error('Upload error:', error);
        progressText.textContent = 'Error processing invoice';
        showToast('Upload Failed', 'There was an error processing your invoice', 'error');
        setTimeout(() => {
          progressContainer.classList.remove('active');
          resetProgressSteps();
        }, 3000);
      }
    }

    async function waitForProcessing(initialCount) {
      const maxAttempts = 15;
      let attempts = 0;
      const sheetId = localStorage.getItem('userSheetId');

      return new Promise((resolve) => {
        const checkInterval = setInterval(async () => {
          attempts++;

          console.log(`Polling attempt ${attempts}/${maxAttempts}...`);

          try {
            const response = await fetch(`${CONFIG.CENTRAL_APPS_SCRIPT_URL}?action=metrics&sheetId=${sheetId}`);
            const data = await response.json();

            console.log(`Current invoices: ${data.totalInvoices}, waiting for: ${initialCount + 1}`);

            if (data.totalInvoices > initialCount) {
              clearInterval(checkInterval);
              console.log(' New invoice detected!');
              resolve(true);
            }

            if (attempts >= maxAttempts) {
              clearInterval(checkInterval);
              console.log(' Polling timeout reached');
              resolve(false);
            }
          } catch (error) {
            console.error('Polling error:', error);
          }
        }, 2000);
      });
    }

    function updateProgressStep(step, status) {
      const stepElement = document.querySelector(`.progress-step[data-step="${step}"]`);
      if (!stepElement) return;

      stepElement.classList.remove('active', 'complete');
      if (status) {
        stepElement.classList.add(status);
      }
    }

    function resetProgressSteps() {
      document.querySelectorAll('.progress-step').forEach(step => {
        step.classList.remove('active', 'complete');
      });
    }

    function showToast(title, message, type = 'success') {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;

      const icon = type === 'success'
        ? '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#34A853" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>'
        : '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#EA4335" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>';

      toast.innerHTML = `
        <div class="toast-icon">${icon}</div>
        <div class="toast-content">
          <div class="toast-title">${title}</div>
          <div class="toast-message">${message}</div>
        </div>
      `;

      container.appendChild(toast);

      setTimeout(() => {
        toast.style.animation = 'slideIn 0.3s ease-out reverse';
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 4000);
    }

    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        const r = Math.random() * 16 | 0;
        const v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    function extractGoogleId(input) {
      if (!input) return '';

      input = input.trim();

      if (!input.includes('/') && !input.includes('http')) {
        return input;
      }

      const sheetMatch = input.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
      if (sheetMatch) {
        return sheetMatch[1];
      }

      const folderMatch = input.match(/\/folders\/([a-zA-Z0-9-_]+)/);
      if (folderMatch) {
        return folderMatch[1];
      }

      return input;
    }

    function takePhoto() {
      showToast('Coming Soon', 'Camera feature will be available in the next update', 'success');
    }

    // Quick Actions Functions
    function toggleQuickActions() {
      const menu = document.getElementById('quickActionsMenu');
      menu.classList.toggle('active');
    }

    // Close menu when clicking outside
    document.addEventListener('click', function (event) {
      const wrapper = document.querySelector('.quick-actions-wrapper');
      const menu = document.getElementById('quickActionsMenu');

      if (wrapper && !wrapper.contains(event.target)) {
        menu.classList.remove('active');
      }
    });

    function openUserSheet() {
      const sheetId = localStorage.getItem('userSheetId');

      if (!sheetId) {
        showToast('Configuration Required', 'Please configure your Sheet ID first', 'error');
        showSetupModal();
        toggleQuickActions();
        return;
      }

      const sheetUrl = `https://docs.google.com/spreadsheets/d/${sheetId}`;
      window.open(sheetUrl, '_blank');
      toggleQuickActions();
    }

    function openUserDrive() {
      const folderId = localStorage.getItem('userFolderId');

      if (!folderId) {
        showToast('Configuration Required', 'Please configure your Folder ID first', 'error');
        showSetupModal();
        toggleQuickActions();
        return;
      }

      const folderUrl = `https://drive.google.com/drive/folders/${folderId}`;
      window.open(folderUrl, '_blank');
      toggleQuickActions();
    }

    function refreshDashboard() {
      showToast('Refreshing', 'Loading latest data...', 'success');
      loadDashboard();
      toggleQuickActions();
    }

    // Chart functionality
    let invoiceChart = null;
    let currentPeriod = 'week';

    async function loadChartData(period) {
      currentPeriod = period;

      // Update button states
      document.querySelectorAll('.chart-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.toLowerCase() === period.toLowerCase()) {
          btn.classList.add('active');
        }
      });

      const sheetId = localStorage.getItem('userSheetId');
      if (!sheetId) {
        console.warn(' No Sheet ID configured');
        createEmptyChart(period);
        return;
      }

      try {
        const response = await fetch(`${CONFIG.CENTRAL_APPS_SCRIPT_URL}?action=chartData&sheetId=${sheetId}&period=${period}`);
        const data = await response.json();

        if (data.labels && data.values) {
          console.log(' Real data from Sheet:', data);
          createChart(data.labels, data.values);
        } else {
          console.warn(' No data returned from API');
          createEmptyChart(period);
        }
      } catch (error) {
        console.error(' Error loading chart data:', error);
        createEmptyChart(period);
      }
    }

    function createEmptyChart(period) {
      let labels, values;

      if (period === 'week') {
        labels = [];
        values = [];
        for (let i = 6; i >= 0; i--) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          labels.push(`${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}`);
          values.push(0);
        }
      } else if (period === 'month') {
        labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
        values = [0, 0, 0, 0];
      } else {
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const now = new Date();
        labels = [];
        values = [];
        for (let i = 11; i >= 0; i--) {
          const date = new Date(now);
          date.setMonth(date.getMonth() - i);
          labels.push(`${months[date.getMonth()]} ${date.getFullYear()}`);
          values.push(0);
        }
      }

      console.log(' Showing empty chart (no real data available)');
      createChart(labels, values);
    }

    function createChart(labels, data) {
      console.log(' Creating chart with:', { labels, data });
      console.log('Chart.js available:', typeof Chart !== 'undefined');

      const ctx = document.getElementById('invoiceChart');
      console.log('Canvas element:', ctx);

      if (!ctx) {
        console.error(' Canvas element not found!');
        return;
      }

      if (invoiceChart) {
        invoiceChart.destroy();
      }

      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      const gridColor = isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
      const textColor = isDark ? '#D4D4D4' : '#202124';

      try {
        invoiceChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: 'Invoices Processed',
              data: data,
              backgroundColor: 'rgba(66, 133, 244, 0.8)',
              borderColor: 'rgba(66, 133, 244, 1)',
              borderWidth: 2,
              borderRadius: 8,
              borderSkipped: false,
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                backgroundColor: isDark ? '#3C3C3C' : '#FFFFFF',
                titleColor: textColor,
                bodyColor: textColor,
                borderColor: gridColor,
                borderWidth: 1,
                padding: 12,
                displayColors: false,
                callbacks: {
                  title: function (context) {
                    return context[0].label;
                  },
                  label: function (context) {
                    return `${context.parsed.y} invoice${context.parsed.y !== 1 ? 's' : ''}`;
                  }
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  stepSize: 1,
                  color: textColor,
                  font: {
                    size: 11
                  }
                },
                grid: {
                  color: gridColor,
                  drawBorder: false
                }
              },
              x: {
                ticks: {
                  color: textColor,
                  font: {
                    size: 11
                  }
                },
                grid: {
                  display: false
                }
              }
            }
          }
        });
        console.log(' Chart created successfully');
      } catch (error) {
        console.error(' Error creating chart:', error);
      }
    }

    async function loadInitialChart() {
      await loadChartData('week');
    }

    function viewAllInvoices() {
      const folderId = localStorage.getItem('userFolderId');

      if (!folderId) {
        showToast('Configuration Required', 'Please configure your Folder ID first', 'error');
        showSetupModal();
        return;
      }

      const folderUrl = `https://drive.google.com/drive/folders/${folderId}`;
      window.open(folderUrl, '_blank');
    }

    function updateConnectButton() {
      const sheetId = localStorage.getItem('userSheetId');
      const folderId = localStorage.getItem('userFolderId');
      const connectBtn = document.getElementById('connectBtn');

      if (sheetId && folderId) {
        connectBtn.classList.add('connected');
        connectBtn.innerHTML = `
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Connected
        `;
        connectBtn.title = 'System connected - Click to change settings';
      }
    }

    const uploadArea = document.getElementById('uploadArea');
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('drag-over');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('drag-over');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('drag-over');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        uploadInvoice(files[0]);
      }
    });

    window.addEventListener('load', () => {
      initTheme();
      checkConfiguration();
    });
  </script>
</body>

</html>

